{% extends "barmanager/admin/base.html" %}

{% block title %}Proveedores - BarManager Pro{% endblock %}

{% block page_title %}Gestión de Proveedores{% endblock %}

{% block content %}
<!-- Estadísticas de Proveedores -->
<div class="row mb-4">
    <div class="col-md-3">
        <div class="card stats-card">
            <div class="card-body text-center">
                <i class="fas fa-truck fa-2x text-primary mb-2"></i>
                <h4 class="fw-bold">{{ proveedores|length if proveedores else 5 }}</h4>
                <small class="text-muted">Total Proveedores</small>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card stats-card-success">
            <div class="card-body text-center">
                <i class="fas fa-check-circle fa-2x text-success mb-2"></i>
                <h4 class="fw-bold">{{ proveedores|selectattr('activo')|list|length if proveedores else 4 }}</h4>
                <small class="text-muted">Proveedores Activos</small>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card stats-card-info">
            <div class="card-body text-center">
                <i class="fas fa-shopping-cart fa-2x text-info mb-2"></i>
                <h4 class="fw-bold">23</h4>
                <small class="text-muted">Órdenes Este Mes</small>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card stats-card-warning">
            <div class="card-body text-center">
                <i class="fas fa-dollar-sign fa-2x text-warning mb-2"></i>
                <h4 class="fw-bold">$1,250,000</h4>
                <small class="text-muted">Compras Este Mes</small>
            </div>
        </div>
    </div>
</div>

<!-- Panel de Control -->
<div class="row mb-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0"><i class="fas fa-truck me-2"></i>Gestión de Proveedores</h5>
                <div class="btn-group">
                    <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#modalProveedor">
                        <i class="fas fa-plus me-2"></i>Nuevo Proveedor
                    </button>
                    <button class="btn btn-info" onclick="exportarProveedores()">
                        <i class="fas fa-download me-2"></i>Exportar
                    </button>
                </div>
            </div>
            <div class="card-body">
                <!-- Filtros -->
                <div class="row mb-3">
                    <div class="col-md-4">
                        <input type="text" class="form-control" id="buscarProveedor" placeholder="Buscar proveedor...">
                    </div>
                    <div class="col-md-3">
                        <select class="form-select" id="filtroEstado">
                            <option value="">Todos los estados</option>
                            <option value="activo">Activos</option>
                            <option value="inactivo">Inactivos</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <select class="form-select" id="filtroTipo">
                            <option value="">Todos los tipos</option>
                            <option value="bebidas">Bebidas</option>
                            <option value="alimentos">Alimentos</option>
                            <option value="suministros">Suministros</option>
                            <option value="servicios">Servicios</option>
                        </select>
                    </div>
                    <div class="col-md-2">
                        <button class="btn btn-outline-secondary w-100" onclick="limpiarFiltros()">
                            <i class="fas fa-eraser me-2"></i>Limpiar
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Tabs de Gestión -->
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <ul class="nav nav-tabs card-header-tabs" id="proveedoresTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="lista-tab" data-bs-toggle="tab" data-bs-target="#lista" type="button" role="tab">
                            <i class="fas fa-list me-2"></i>Lista de Proveedores
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="ordenes-tab" data-bs-toggle="tab" data-bs-target="#ordenes" type="button" role="tab">
                            <i class="fas fa-shopping-cart me-2"></i>Órdenes de Compra
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="evaluacion-tab" data-bs-toggle="tab" data-bs-target="#evaluacion" type="button" role="tab">
                            <i class="fas fa-star me-2"></i>Evaluación
                        </button>
                    </li>
                </ul>
            </div>
            <div class="card-body">
                <div class="tab-content" id="proveedoresTabsContent">
                    <!-- Tab Lista de Proveedores -->
                    <div class="tab-pane fade show active" id="lista" role="tabpanel">
                        <div class="table-responsive">
                            <table class="table table-hover" id="tablaProveedores">
                                <thead class="table-dark">
                                    <tr>
                                        <th>Empresa</th>
                                        <th>Contacto</th>
                                        <th>Información</th>
                                        <th>Tipo</th>
                                        <th>Última Compra</th>
                                        <th>Total Compras</th>
                                        <th>Evaluación</th>
                                        <th>Estado</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for proveedor in proveedores %}
                                    <tr data-estado="{% if proveedor.activo %}activo{% else %}inactivo{% endif %}" data-tipo="bebidas">
                                        <td>
                                            <div class="d-flex align-items-center">
                                                <div class="company-logo me-2">
                                                    <i class="fas fa-building fa-2x text-primary"></i>
                                                </div>
                                                <div>
                                                    <strong>{{ proveedor.nombre_empresa }}</strong>
                                                    <br><small class="text-muted">Desde: {{ proveedor.fecha_registro or '2024-01-01' }}</small>
                                                </div>
                                            </div>
                                        </td>
                                        <td>
                                            <strong>{{ proveedor.contacto or 'No asignado' }}</strong>
                                            <br><small class="text-muted">
                                                <i class="fas fa-phone me-1"></i>{{ proveedor.telefono or 'No registrado' }}
                                            </small>
                                            <br><small class="text-muted">
                                                <i class="fas fa-envelope me-1"></i>{{ proveedor.email or 'No registrado' }}
                                            </small>
                                        </td>
                                        <td>
                                            <small>{{ proveedor.direccion or 'Dirección no registrada' }}</small>
                                        </td>
                                        <td>
                                            <span class="badge bg-info">Bebidas</span>
                                        </td>
                                        <td>
                                            <small>15/01/2025</small>
                                            <br><small class="text-muted">Hace 3 días</small>
                                        </td>
                                        <td class="text-success fw-bold">$450,000</td>
                                        <td>
                                            <div class="text-warning">
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="far fa-star"></i>
                                                <br><small>4.2/5</small>
                                            </div>
                                        </td>
                                        <td>
                                            {% if proveedor.activo %}
                                            <span class="badge bg-success">Activo</span>
                                            {% else %}
                                            <span class="badge bg-danger">Inactivo</span>
                                            {% endif %}
                                        </td>
                                        <td>
                                            <div class="btn-group btn-group-sm">
                                                <button class="btn btn-outline-primary" onclick="editarProveedor('{{ proveedor.id }}')" title="Editar">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                                <button class="btn btn-outline-info" onclick="verHistorial('{{ proveedor.id }}')" title="Historial">
                                                    <i class="fas fa-history"></i>
                                                </button>
                                                <button class="btn btn-outline-success" onclick="nuevaOrden('{{ proveedor.id }}')" title="Nueva Orden">
                                                    <i class="fas fa-shopping-cart"></i>
                                                </button>
                                                <button class="btn btn-outline-warning" onclick="evaluarProveedor('{{ proveedor.id }}')" title="Evaluar">
                                                    <i class="fas fa-star"></i>
                                                </button>
                                                {% if proveedor.activo %}
                                                <button class="btn btn-outline-danger" onclick="desactivarProveedor('{{ proveedor.id }}')" title="Desactivar">
                                                    <i class="fas fa-times"></i>
                                                </button>
                                                {% else %}
                                                <button class="btn btn-outline-success" onclick="activarProveedor('{{ proveedor.id }}')" title="Activar">
                                                    <i class="fas fa-check"></i>
                                                </button>
                                                {% endif %}
                                            </div>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                    
                                    <!-- Proveedores adicionales de ejemplo -->
                                    <tr data-estado="activo" data-tipo="alimentos">
                                        <td>
                                            <div class="d-flex align-items-center">
                                                <div class="company-logo me-2">
                                                    <i class="fas fa-building fa-2x text-success"></i>
                                                </div>
                                                <div>
                                                    <strong>Alimentos Frescos Ltda</strong>
                                                    <br><small class="text-muted">Desde: 2024-03-15</small>
                                                </div>
                                            </div>
                                        </td>
                                        <td>
                                            <strong>Carmen López</strong>
                                            <br><small class="text-muted">
                                                <i class="fas fa-phone me-1"></i>+57 301 888 9999
                                            </small>
                                            <br><small class="text-muted">
                                                <i class="fas fa-envelope me-1"></i>carmen@alimentosfrescos.com
                                            </small>
                                        </td>
                                        <td>
                                            <small>Calle 80 #15-25, Bogotá</small>
                                        </td>
                                        <td>
                                            <span class="badge bg-success">Alimentos</span>
                                        </td>
                                        <td>
                                            <small>12/01/2025</small>
                                            <br><small class="text-muted">Hace 6 días</small>
                                        </td>
                                        <td class="text-success fw-bold">$320,000</td>
                                        <td>
                                            <div class="text-warning">
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <br><small>5.0/5</small>
                                            </div>
                                        </td>
                                        <td>
                                            <span class="badge bg-success">Activo</span>
                                        </td>
                                        <td>
                                            <div class="btn-group btn-group-sm">
                                                <button class="btn btn-outline-primary" onclick="editarProveedor('3')" title="Editar">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                                <button class="btn btn-outline-info" onclick="verHistorial('3')" title="Historial">
                                                    <i class="fas fa-history"></i>
                                                </button>
                                                <button class="btn btn-outline-success" onclick="nuevaOrden('3')" title="Nueva Orden">
                                                    <i class="fas fa-shopping-cart"></i>
                                                </button>
                                                <button class="btn btn-outline-warning" onclick="evaluarProveedor('3')" title="Evaluar">
                                                    <i class="fas fa-star"></i>
                                                </button>
                                                <button class="btn btn-outline-danger" onclick="desactivarProveedor('3')" title="Desactivar">
                                                    <i class="fas fa-times"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                    
                                    <tr data-estado="activo" data-tipo="suministros">
                                        <td>
                                            <div class="d-flex align-items-center">
                                                <div class="company-logo me-2">
                                                    <i class="fas fa-building fa-2x text-warning"></i>
                                                </div>
                                                <div>
                                                    <strong>Suministros Hostelería</strong>
                                                    <br><small class="text-muted">Desde: 2024-06-01</small>
                                                </div>
                                            </div>
                                        </td>
                                        <td>
                                            <strong>Diego Ramírez</strong>
                                            <br><small class="text-muted">
                                                <i class="fas fa-phone me-1"></i>+57 301 777 8888
                                            </small>
                                            <br><small class="text-muted">
                                                <i class="fas fa-envelope me-1"></i>diego@suministros.com
                                            </small>
                                        </td>
                                        <td>
                                            <small>Zona Industrial, Bogotá</small>
                                        </td>
                                        <td>
                                            <span class="badge bg-warning text-dark">Suministros</span>
                                        </td>
                                        <td>
                                            <small>08/01/2025</small>
                                            <br><small class="text-muted">Hace 10 días</small>
                                        </td>
                                        <td class="text-success fw-bold">$180,000</td>
                                        <td>
                                            <div class="text-warning">
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="far fa-star"></i>
                                                <br><small>3.8/5</small>
                                            </div>
                                        </td>
                                        <td>
                                            <span class="badge bg-success">Activo</span>
                                        </td>
                                        <td>
                                            <div class="btn-group btn-group-sm">
                                                <button class="btn btn-outline-primary" onclick="editarProveedor('4')" title="Editar">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                                <button class="btn btn-outline-info" onclick="verHistorial('4')" title="Historial">
                                                    <i class="fas fa-history"></i>
                                                </button>
                                                <button class="btn btn-outline-success" onclick="nuevaOrden('4')" title="Nueva Orden">
                                                    <i class="fas fa-shopping-cart"></i>
                                                </button>
                                                <button class="btn btn-outline-warning" onclick="evaluarProveedor('4')" title="Evaluar">
                                                    <i class="fas fa-star"></i>
                                                </button>
                                                <button class="btn btn-outline-danger" onclick="desactivarProveedor('4')" title="Desactivar">
                                                    <i class="fas fa-times"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Tab Órdenes de Compra -->
                    <div class="tab-pane fade" id="ordenes" role="tabpanel">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <button class="btn btn-success" onclick="nuevaOrdenCompra()">
                                    <i class="fas fa-plus me-2"></i>Nueva Orden de Compra
                                </button>
                            </div>
                            <div class="col-md-6">
                                <div class="input-group">
                                    <input type="text" class="form-control" placeholder="Buscar orden...">
                                    <button class="btn btn-outline-secondary">
                                        <i class="fas fa-search"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead class="table-dark">
                                    <tr>
                                        <th>Orden</th>
                                        <th>Proveedor</th>
                                        <th>Fecha</th>
                                        <th>Items</th>
                                        <th>Total</th>
                                        <th>Estado</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>#OC-001</strong></td>
                                        <td>Distribuidora de Bebidas SA</td>
                                        <td>15/01/2025</td>
                                        <td>
                                            <small>
                                                50x Cerveza Corona<br>
                                                30x Aguardiente
                                            </small>
                                        </td>
                                        <td class="text-success fw-bold">$450,000</td>
                                        <td><span class="badge bg-warning">Pendiente</span></td>
                                        <td>
                                            <div class="btn-group btn-group-sm">
                                                <button class="btn btn-outline-primary" title="Ver">
                                                    <i class="fas fa-eye"></i>
                                                </button>
                                                <button class="btn btn-outline-success" title="Recibir">
                                                    <i class="fas fa-check"></i>
                                                </button>
                                                <button class="btn btn-outline-info" title="Imprimir">
                                                    <i class="fas fa-print"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><strong>#OC-002</strong></td>
                                        <td>Alimentos Frescos Ltda</td>
                                        <td>12/01/2025</td>
                                        <td>
                                            <small>
                                                20kg Carne de res<br>
                                                15kg Pollo
                                            </small>
                                        </td>
                                        <td class="text-success fw-bold">$320,000</td>
                                        <td><span class="badge bg-success">Recibida</span></td>
                                        <td>
                                            <div class="btn-group btn-group-sm">
                                                <button class="btn btn-outline-primary" title="Ver">
                                                    <i class="fas fa-eye"></i>
                                                </button>
                                                <button class="btn btn-outline-info" title="Imprimir">
                                                    <i class="fas fa-print"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Tab Evaluación -->
                    <div class="tab-pane fade" id="evaluacion" role="tabpanel">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header">
                                        <h6 class="mb-0">Ranking de Proveedores</h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-center mb-2">
                                            <span>1. Alimentos Frescos Ltda</span>
                                            <div class="text-warning">
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <small class="ms-1">5.0</small>
                                            </div>
                                        </div>
                                        <div class="d-flex justify-content-between align-items-center mb-2">
                                            <span>2. Distribuidora de Bebidas SA</span>
                                            <div class="text-warning">
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="far fa-star"></i>
                                                <small class="ms-1">4.2</small>
                                            </div>
                                        </div>
                                        <div class="d-flex justify-content-between align-items-center mb-2">
                                            <span>3. Suministros Hostelería</span>
                                            <div class="text-warning">
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="far fa-star"></i>
                                                <small class="ms-1">3.8</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header">
                                        <h6 class="mb-0">Criterios de Evaluación</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="list-unstyled">
                                            <li><i class="fas fa-check text-success me-2"></i>Calidad de productos</li>
                                            <li><i class="fas fa-check text-success me-2"></i>Puntualidad en entregas</li>
                                            <li><i class="fas fa-check text-success me-2"></i>Precios competitivos</li>
                                            <li><i class="fas fa-check text-success me-2"></i>Servicio al cliente</li>
                                            <li><i class="fas fa-check text-success me-2"></i>Flexibilidad en pagos</li>
                                            <li><i class="fas fa-check text-success me-2"></i>Disponibilidad de productos</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal Nuevo/Editar Proveedor -->
<div class="modal fade" id="modalProveedor" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="fas fa-truck me-2"></i>
                    <span id="tituloModalProveedor">Nuevo Proveedor</span>
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <form id="formProveedor">
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Nombre de la Empresa *</label>
                                <input type="text" class="form-control" id="nombreEmpresa" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Tipo de Proveedor *</label>
                                <select class="form-select" id="tipoProveedor" required>
                                    <option value="">Seleccionar tipo</option>
                                    <option value="bebidas">Bebidas</option>
                                    <option value="alimentos">Alimentos</option>
                                    <option value="suministros">Suministros</option>
                                    <option value="servicios">Servicios</option>
                                    <option value="limpieza">Limpieza</option>
                                    <option value="mantenimiento">Mantenimiento</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Persona de Contacto</label>
                                <input type="text" class="form-control" id="contactoProveedor">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Teléfono</label>
                                <input type="tel" class="form-control" id="telefonoProveedor">
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Email</label>
                                <input type="email" class="form-control" id="emailProveedor">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Sitio Web</label>
                                <input type="url" class="form-control" id="sitioWebProveedor">
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">Dirección</label>
                        <textarea class="form-control" id="direccionProveedor" rows="2"></textarea>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Condiciones de Pago</label>
                                <select class="form-select" id="condicionesPago">
                                    <option value="">Seleccionar</option>
                                    <option value="contado">Contado</option>
                                    <option value="15_dias">15 días</option>
                                    <option value="30_dias">30 días</option>
                                    <option value="45_dias">45 días</option>
                                    <option value="60_dias">60 días</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Descuento por Volumen (%)</label>
                                <input type="number" class="form-control" id="descuentoVolumen" min="0" max="100" step="0.1">
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">Observaciones</label>
                        <textarea class="form-control" id="observacionesProveedor" rows="3"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save me-2"></i>Guardar Proveedor
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Variables globales
let proveedorEditando = null;

// Inicialización
document.addEventListener('DOMContentLoaded', function() {
    // Filtros
    document.getElementById('buscarProveedor').addEventListener('input', filtrarProveedores);
    document.getElementById('filtroEstado').addEventListener('change', filtrarProveedores);
    document.getElementById('filtroTipo').addEventListener('change', filtrarProveedores);
    
    // Formulario
    document.getElementById('formProveedor').addEventListener('submit', guardarProveedor);
});

// Filtrar proveedores
function filtrarProveedores() {
    const busqueda = document.getElementById('buscarProveedor').value.toLowerCase();
    const estado = document.getElementById('filtroEstado').value;
    const tipo = document.getElementById('filtroTipo').value;
    
    const filas = document.querySelectorAll('#tablaProveedores tbody tr');
    
    filas.forEach(fila => {
        const texto = fila.textContent.toLowerCase();
        const estadoFila = fila.dataset.estado;
        const tipoFila = fila.dataset.tipo;
        
        let mostrar = true;
        
        if (busqueda && !texto.includes(busqueda)) {
            mostrar = false;
        }
        
        if (estado && estadoFila !== estado) {
            mostrar = false;
        }
        
        if (tipo && tipoFila !== tipo) {
            mostrar = false;
        }
        
        fila.style.display = mostrar ? '' : 'none';
    });
}

// Limpiar filtros
function limpiarFiltros() {
    document.getElementById('buscarProveedor').value = '';
    document.getElementById('filtroEstado').value = '';
    document.getElementById('filtroTipo').value = '';
    filtrarProveedores();
}

// Editar proveedor
function editarProveedor(id) {
    proveedorEditando = id;
    document.getElementById('tituloModalProveedor').textContent = 'Editar Proveedor';
    
    showToast('Función de edición disponible en versión completa', 'info');
    
    const modal = new bootstrap.Modal(document.getElementById('modalProveedor'));
    modal.show();
}

// Guardar proveedor
function guardarProveedor(e) {
    e.preventDefault();
    
    const formData = {
        nombreEmpresa: document.getElementById('nombreEmpresa').value,
        tipo: document.getElementById('tipoProveedor').value,
        contacto: document.getElementById('contactoProveedor').value,
        telefono: document.getElementById('telefonoProveedor').value,
        email: document.getElementById('emailProveedor').value,
        sitioWeb: document.getElementById('sitioWebProveedor').value,
        direccion: document.getElementById('direccionProveedor').value,
        condicionesPago: document.getElementById('condicionesPago').value,
        descuentoVolumen: document.getElementById('descuentoVolumen').value,
        observaciones: document.getElementById('observacionesProveedor').value
    };
    
    if (!formData.nombreEmpresa || !formData.tipo) {
        showToast('Complete los campos obligatorios', 'error');
        return;
    }
    
    showToast(proveedorEditando ? 'Proveedor actualizado correctamente' : 'Proveedor creado correctamente', 'success');
    
    bootstrap.Modal.getInstance(document.getElementById('modalProveedor')).hide();
    document.getElementById('formProveedor').reset();
    proveedorEditando = null;
    
    setTimeout(() => location.reload(), 1500);
}

// Ver historial
function verHistorial(id) {
    showToast('Historial del proveedor disponible en versión completa', 'info');
}

// Nueva orden
function nuevaOrden(id) {
    showToast('Función de nueva orden disponible en versión completa', 'info');
}

// Evaluar proveedor
function evaluarProveedor(id) {
    showToast('Sistema de evaluación disponible en versión completa', 'info');
}

// Activar/Desactivar proveedor
function desactivarProveedor(id) {
    if (confirm('¿Está seguro de desactivar este proveedor?')) {
        showToast('Proveedor desactivado correctamente', 'success');
        setTimeout(() => location.reload(), 1500);
    }
}

function activarProveedor(id) {
    showToast('Proveedor activado correctamente', 'success');
    setTimeout(() => location.reload(), 1500);
}

// Nueva orden de compra
function nuevaOrdenCompra() {
    showToast('Función de nueva orden de compra disponible en versión completa', 'info');
}

// Exportar proveedores
function exportarProveedores() {
    showToast('Exportando proveedores a Excel...', 'success');
}

// Función para mostrar notificaciones
function showToast(message, type = 'info') {
    const toast = document.createElement('div');
    toast.className = `alert alert-${type === 'error' ? 'danger' : type} alert-dismissible fade show position-fixed`;
    toast.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
    toast.innerHTML = `
        ${message}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    `;
    
    document.body.appendChild(toast);
    
    setTimeout(() => {
        if (toast.parentNode) {
            toast.parentNode.removeChild(toast);
        }
    }, 3000);
}
</script>
{% endblock %}